\documentclass[11.5pt,a4paper,oneside]{article}
\usepackage{programming}
\usepackage{mathtools}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}

\renewcommand{\contestname}{
دانشگاه تهران، دانشکده مهندسی برق و کامپیوتر \\
تحلیل و طراحی الگوریتم‌ها \\
}

\renewcommand{\contestauthor}{
تمرین کامپیوتری سوم \\ موعد تحویل: شنبه ۲۱ اردیبهشت، ساعت ۲۳:۵۵ \\ طراح:‌ محمد فغان‌پور گنجی،
\texttt{mohammadganji@ut.ac.ir}
}

\begin{document}

{\noindent \Large \bf \contestname}
{\contestauthor}

\begin{flushleft}
\nothing\\[-3.2cm]
\includegraphics[height=2.5cm]{../../../../static/pics/ut-eng.png}
\end{flushleft}

\def\problemCode{Election}
\def\problemEnglishTitle{Election}
\def\problemFarsiTitle{انتخابات}
\def\timeLimit{$2$ \second}
\def\memLimit{$256$ \megabytes}
\begin{problem}
ژیوار در انتخابات پادشاهی! کشور "صورتی" شرکت کرده است، او پس از انتخاب اعضای ستادش جاهایی در پایتخت برای ستادهایش در نظر گرفته است.

هادی به عنوان نماینده‌ی ژیوار می‌خواهد از ستاد شماره‌ی ۱ به ستاد شماره‌ی $n$ برود. در شهر، بین بعضی از ستاد‌ها خیابان‌های دوطرفه وجود دارد که هادی می‌تواند از آن‌ها استفاده کند. گذر از هر خیابان برای رفتن از یک ستاد به ستاد دیگر یک مقدار صحیح مثبت زمان می‌برد. یک مساله‌ی خاص وجود دارد آن هم این است که در برخی زمان‌های خاص درب ستاد‌ها برای یک ثانیه بسته می‌شود و اگر هادی در زمانِ بسته شدن درب ستاد آنجا باشد، باید یک ثانیه صبر کند.

از آنجا که زمان زیادی به انتخابات باقی نمانده و هادی باید از ستاد شماره ۱ به ستاد شماره $n$ برود، از شما کمک خواسته که با داشتن اطلاعات راجع به خیابان ها و مدت زمان لازم برای گذر از هر خیابان و نیز زمان بسته شدن درب هر ستاد، کمترین زمان لازم برای آنکه هادی از ستاد شماره ۱ به ستاد شماره $n$ برود را بدست آورید.
\inputDescription
در خط اول ورودی  دو عدد $n$ و $m$ می‌آید که به ترتیب نشان‌دهنده‌ی تعداد ستاد‌ها و تعداد خیابان‌های میان آنهاست.\\
سپس در $m$ خط بعدی، در هر خط سه عدد $a$ و $b$ و $t$ می‌آید که به ترتیب شماره‌ی ستاد اول، شماره‌ی ستاد دوم و زمان لازم (به ثانیه) برای طی کردن خیابان بین آنهاست.\\
سپس در $n$ خط بعدی، در هر خط یک عدد
$k_{i}$
می‌آید، سپس پس از آن 
$k_{i}$
عدد می‌آیند که عدد $j$ام آن، نشان‌دهنده بسته بودن ستاد $i$ام در ثانیه $j$ است.
\outputDescription
در تنها خط خروجی کمترین زمانی که لازم است تا هادی بتواند از ستاد شماره ۱ به ستاد شماره $n$ برسد را چاپ کنید.
در صورتی که هیچ راهی برای رسیدن از ستاد شماره ۱ به ستاد شماره $n$ وجود ندارد، مقدار $-1$ را چاپ کنید.

\constraints
\begin{shortitems}
\item $2 \le n \le 10^5$
\item $0 \le m \le 10^5$
\item $1 \le t \le 10^4$
\item $0 \le k_{i} \le 10^5$
\end{shortitems}

\sampleIO

\begin{example}
\exmp{%
2 1
1 2 3
0
1 3
}{%
3
}%
\exmp{%
3 3
1 2 3
2 3 2
1 3 7
}{%
5
}%
\end{example}

\end{problem}


\def\problemCode{Repairing Roads}
\def\problemEnglishTitle{Repairing Roads}
\def\problemFarsiTitle{بازسازی جاده‌ها}
\def\timeLimit{$2$ \second}
\def\memLimit{$256$ \megabytes}
\begin{problem}
ژیوار با درایت خود و کمک شما در مساله‌ی قبلی، توانست پادشاه کشور "صورتی" شود. در این کشور تعدادی جاده‌ی دوطرفه‌ وجود دارد که دو شهر را به هم وصل می‌کند، با جاده‌های فعلی این کشور می‌توان از هر شهری به هر شهر دیگری سفر کرد.
ژیوار به عنوان اولین اقدام قول داده که بعضی جاده‌های بین شهر‌ها را بازسازی کند به طوری که فقط با استفاده از جاده‌های بازسازی شده هم بتوان از هر شهری به هر شهر دیگری سفر کرد.

بازسازی هر جاده هزینه‌ی خاص خود را دارد. ژیوار کار را به وزارت راه‌سازی سپرده است، اما با یک شرط که در بین جاده‌هایی که باز‌سازی می‌شوند، حتما یک جاده‌ی خاص وجود داشته باشد، اما این جاده‌ را هنوز مشخص نکرده است.
\\
از آنجایی که وزارت راه‌سازی از بابت زمان نگران است، از شما کمک خواسته که بتوانید به ازای هر جاده‌ای که ژیوار مشخص می‌کند، جاده‌هایی که باید بازسازی شوند را مشخص کنید به طوری که بازسازی آنها کمترین هزینه‌ی ممکن را داشته باشد و جاده‌ی مشخص شده توسط ژیوار حتما بین لیست جاده‌هایی که باید بازسازی شوند وجود داشته باشد.

شما باید با داشتن اطلاعات جاده‌های بین شهری موجود در کشور، و هزینه‌ی بازسازی هر جاده، لیست جاده‌هایی که باید بازسازی شوند که اولا با استفاده از آن جاده‌ها بتوان از هر شهری به هر شهر دیگری سفر کرد، دوما جاده‌ی مشخص شده‌ی ژیوار حتما در بین لیست جاده‌هایی که باید بازسازی شوند باشد، سوما این جاده‌ها در مجموع کمترین هزینه‌ی ممکن را داشته باشند.

\inputDescription
در خط اول ورودی دو عدد $n$ و $r$ می‌آید که به ترتیب تعداد شهر‌ها و تعداد جاده‌های موجود بین شهر‌هاست.\\
شهرها از ۱ تا $n$ شماره گذاری شده اند. در $r$ خط بعدی هر خط سه عدد $a$ و $b$ و $c$ می‌آید که جاده‌ی موجود بین دو شهر را توصیف می‌کند، این سه عدد به ترتیب شماره‌ی شهر اول، شهر دوم و هزینه‌ی بازسازی جاده‌ی بین آنهاست.\\
در خط بعد یک عدد $q$ می‌آید که نشان دهنده‌ی تعداد درخواست‌های مختلف ژیوار است، در $q$ خط بعدی هر خط دو عدد $u$ و $v$ می‌آید که نشان‌دهنده‌ی جاده‌ی بین دو شهر است که ژیوار تعیین کرده که حتما باید بازسازی شود.

\outputDescription
در $q$ خط، به ازای هر یک از جاده‌های مشخص شده توسط ژیوار یک عدد چاپ کنید که نشان‌دهنده‌ی کمترین هزینه‌ی لازم برای بازسازی جاده‌هاست به طوری که جاده‌ی مشخص شده‌ی ژیوار حتما در آن باشد.

\constraints
\begin{shortitems}
\item $2 \le n \le 10^5$
\item $n-1 \le r \le 2 \times 10^5$
\item $1 \le a, b \le n$
\item $1 \le u, v \le n$
\item $1 \le c \le 10^4$
\item $1 \le q \le 10^3$
\end{shortitems}

\sampleIO

\begin{example}
\exmp{%
3 3
1 2 10
2 3 5
1 3 7
3
2 3
1 2
1 3
}{%
12
15
12
}%
\end{example}

\sampleIODescription
در مثال بالا کشور صورتی سه شهر ۱ و ۲ و ۳ دارد که بین هر سه تای آنها جاده وجود دارد،‌ و ژیوار سه بار درخواست داده که بار اول حتما باید جاده‌ی بین شهر‌های ۲ و ۳ باز‌سازی شود، بار دوم حتما باید جاده‌ی بین شهر‌های ۱ و ۲ بازسازی شود و بار سوم حتما باید جاده‌ی بین شهر‌های ۱ و ۳ بازسازی شود.
\end{problem}

\end{document}